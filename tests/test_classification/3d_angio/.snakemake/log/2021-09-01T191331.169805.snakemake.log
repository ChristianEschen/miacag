Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Job stats:
job            count    min threads    max threads
-----------  -------  -------------  -------------
all                1              1              1
preprocess         1              1              1
test_model         1              1              1
train_model        1              1              1
total              4              1              1


[Wed Sep  1 19:13:31 2021]
rule preprocess:
    input: ../../../data/angio/pre_train.csv, ../../../data/angio/pre_val.csv, /home/sauroman/mia/configs/classification/_3D/classification_config_train_nifty_angio.yaml
    output: ../../../data/angio/train.csv, ../../../data/angio/val.csv, ../../../data/angio/minc_file_path, runs/460bb9e5-0c15-4748-88dc-d3d393deefa8.yaml
    jobid: 1
    resources: tmpdir=/tmp

[Wed Sep  1 19:13:35 2021]
Finished job 1.
1 of 4 steps (25%) done

[Wed Sep  1 19:13:35 2021]
rule train_model:
    input: ../../../data/angio/minc_file_path, ../../../data/angio/train.csv, ../../../data/angio/minc_file_path, ../../../data/angio/val.csv
    output: runs/e06c348a-f332-40cc-bd28-5c0ef954fbc5.log
    jobid: 2
    resources: tmpdir=/tmp

[Wed Sep  1 19:13:35 2021]
Error in rule train_model:
    jobid: 2
    output: runs/e06c348a-f332-40cc-bd28-5c0ef954fbc5.log
    shell:
        
       python -m torch.distributed.launch \
       --nproc_per_node 1 \
       --nnodes 1 \
       --node_rank 0 \
       --master_addr 127.0.1.1 \
       --master_port 1234 \
       ../../trainer.py \
       --config runs/460bb9e5-0c15-4748-88dc-d3d393deefa8.yaml \
       --TraindataRoot ../../../data/angio/minc_file_path \
       --TraindataCSV ../../../data/angio/train.csv \
       --ValdataRoot ../../../data/angio/minc_file_path \
       --ValdataCSV ../../../data/angio/val.csv \
       --cpu True \
       --num_workers 2 \
       --logfile runs/e06c348a-f332-40cc-bd28-5c0ef954fbc5.log \
       --tensorboard_comment test
       
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/sauroman/mia/tests/test_classification/3d_angio/.snakemake/log/2021-09-01T191331.169805.snakemake.log
